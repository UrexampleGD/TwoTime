--This is open source. I would like to apologize if anything error. You can fix it or dm me on discord to fix and update this!
--I would also thanks to Herlow for working with me, he made some of the stab function! Thank you Herlow!!

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local gui = Instance.new("ScreenGui")
gui.Name = "two"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = player:WaitForChild("PlayerGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 260, 0, 150)
Frame.Position = UDim2.new(0.5, -130, 0.5, -75)
Frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
Frame.BorderSizePixel = 0
Frame.Parent = gui
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 12)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "Two Time Auto Backstab"
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.Parent = Frame

local rangetxt = Instance.new("TextBox")
rangetxt.Size = UDim2.new(0, 230, 0, 35)
rangetxt.Position = UDim2.new(0.5, -115, 0, 45)
rangetxt.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
rangetxt.PlaceholderText = "Enter range (default 4)"
rangetxt.Font = Enum.Font.Gotham
rangetxt.TextColor3 = Color3.fromRGB(255, 255, 255)
rangetxt.TextSize = 16
rangetxt.ClearTextOnFocus = false
rangetxt.Parent = Frame
Instance.new("UICorner", rangetxt).CornerRadius = UDim.new(0, 2)
Instance.new("UIStroke", rangetxt).Color = Color3.fromRGB(255, 255, 255)

local back = Instance.new("TextButton")
back.Size = UDim2.new(0, 230, 0, 40)
back.Position = UDim2.new(0.5, -115, 0, 95)
back.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
back.Text = "Backstab: OFF"
back.Font = Enum.Font.GothamBold
back.TextColor3 = Color3.fromRGB(0, 0, 0)
back.TextSize = 18
back.Parent = Frame
Instance.new("UICorner", back).CornerRadius = UDim.new(0, 3)
Instance.new("UIStroke", back).Color = Color3.fromRGB(255, 255, 255)

local dragging, dragInput, dragStart, startPos
Frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = Frame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)
Frame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

local enabled = false
local killers = {"Jason", "c00lkidd", "JohnDoe", "1x1x1x1", "Noli", "Slasher", "Sixer"}

local function gtdgr()
	local container = player:FindFirstChild("PlayerGui") and player.PlayerGui:FindFirstChild("MainUI") and player.PlayerGui.MainUI:FindFirstChild("AbilityContainer")
	return container and container:FindFirstChild("Dagger")
end

local function fire()
	local btn = gtdgr()
	if btn then
		for _, c in next, getconnections(btn.MouseButton1Click) do
			c:Fire()
		end
	end
end

back.MouseButton1Click:Connect(function()
	enabled = not enabled
	if enabled then
		back.Text = "Backstab: ON"
		TweenService:Create(back, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(255, 255, 255), TextColor3 = Color3.fromRGB(0,0,0)}):Play()
	else
		back.Text = "Backstab: OFF"
		TweenService:Create(back, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(255, 255, 255), TextColor3 = Color3.fromRGB(0,0,0)}):Play()
	end
end)

RunService.Heartbeat:Connect(function()
	if not enabled then return end
	local char = player.Character
	if not char then return end
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	local range = tonumber(rangetxt.Text) or 4
	
	local function checkKiller(killer)
		local khrp = killer:FindFirstChild("HumanoidRootPart")
		if khrp then
			local dist = (hrp.Position - khrp.Position).Magnitude
			if dist <= range then
				local look = khrp.CFrame.LookVector
				local toPlayer = (hrp.Position - khrp.Position).Unit
				if look:Dot(toPlayer) < 0.1 then
					fire()
					return true
				end
			end
		end
		return false
	end
	
	if workspace:FindFirstChild("Players") and workspace.Players:FindFirstChild("Killers") then
		for _, name in pairs(killers) do
			local k = workspace.Players.Killers:FindFirstChild(name)
			if k and checkKiller(k) then
				return
			end
		end
	end
	
	if workspace:FindFirstChild("Killers") then
		for _, killer in pairs(workspace.Killers:GetChildren()) do
			if table.find(killers, killer.Name) and checkKiller(killer) then
				return
			end
		end
	end
	
	for _, killer in pairs(workspace:GetChildren()) do
		if killer:IsA("Model") and killer ~= char then
			local khrp = killer:FindFirstChild("HumanoidRootPart")
			local humanoid = killer:FindFirstChild("Humanoid")
			if khrp and humanoid and humanoid.Health > 0 then
				local dist = (hrp.Position - khrp.Position).Magnitude
				if dist <= range then
					local look = khrp.CFrame.LookVector
					local toPlayer = (hrp.Position - khrp.Position).Unit
					if look:Dot(toPlayer) < 0.1 then
						fire()
						return
					end
				end
			end
		end
	end
end)
